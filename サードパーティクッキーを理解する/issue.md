# 課題 1

## サードパーティクッキーとファーストパーティクッキーの違い

### ファーストパーティクッキー

- ユーザーが直接訪れているウェブサイトによって設定される
- これらのクッキーは、ウェブサイトの機能性を向上させるために使用される
- 例えば、ユーザーのログイン情報を記憶したり、ショッピングカートのアイテムを追跡したり、ユーザーの言語設定を保存したりする

### サードパーティクッキー

- ユーザーが直接訪れていない他のウェブサイトによって設定される
- これは通常、広告やトラッキングサービスによって行われる
- これらのクッキーは、ユーザーのウェブブラウジング活動を追跡し、ユーザーに対する広告をパーソナライズするために使用される
- たとえば、ユーザーがウェブサイト A を訪れたとき、ウェブサイト A はファーストパーティクッキーを設定できると同時に、ウェブサイト A に埋め込まれた広告がウェブサイト B から提供されている場合、ウェブサイト B はサードパーティクッキーを設定できる

## サードパーティ Cookie を用いて広告配信ネットワーク（例えば Google AdSense など）がどのようにユーザの訪問履歴を把握しているか

- ユーザーがウェブサイト A を訪れると、そのサイトに埋め込まれた広告（Google AdSense など）がサードパーティクッキーをユーザーのブラウザに設定する
- このクッキーには一意の ID が含まれており、それによってユーザーを識別する
- ユーザーがその後ウェブサイト B、C、D など、同じ広告ネットワークの広告が表示される他のサイトを訪れると、その都度、広告ネットワークは同じサードパーティクッキーを読み取る
- これにより、広告ネットワークはユーザーが訪れた各サイトとその順序、滞在時間、クリックした広告などの情報を収集し、ユーザーの訪問履歴や興味・行動パターンを把握する
- この情報を基に、広告ネットワークはユーザーに対してパーソナライズされた広告を表示する
- 例えば、ユーザーが旅行サイトを頻繁に訪れている場合、旅行関連の広告が表示される可能性が高くなる

## サードパーティークッキーはどのように生成されるか？

### 画像埋め込み（ピクセルタグ）

- ウェブページに 1x1 ピクセルの透明な画像（または"ピクセルタグ"）を埋め込む方法
- この画像はサードパーティ（例えば広告ネットワーク）のサーバーから提供され、画像をロードするときにクッキーが設定される

### スクリプト埋め込み

- ウェブページに JavaScript などのスクリプトを埋め込む方法
- このスクリプトはサードパーティのサーバーから提供され、スクリプトが実行されるときにクッキーが設定される

### IFrame 埋め込み

- IFrame はウェブページ内に別のウェブページを埋め込むための HTML 要素
- IFrame の中身はサードパーティのサーバーから提供され、そのページがロードされるときにクッキーが設定される

## サードパーティクッキーの扱い

### Google Chrome

- Google は、2024 年後半までにサードパーティクッキーのサポートを段階的に廃止すると発表している
- プライバシーの観点からの変更で、代わりに「プライバシーサンドボックス」という新しいフレームワークを提案している

### Safari

- 「Intelligent Tracking Prevention（ITP）」という機能を導入しており、これによりサードパーティクッキーの使用が大幅に制限される
- 具体的には、ユーザーがサードパーティのウェブサイトを直接訪れない限り、そのウェブサイトからのクッキーはブロックされる

### Firefox

- 「Enhanced Tracking Protection（ETP）」という機能を導入しており、これによりサードパーティクッキーの多くがブロックされる
- ユーザーが訪れたウェブサイトによって設定されたクッキー（ファーストパーティクッキー）は許可するが、ユーザーが直接訪れていないウェブサイト（サードパーティ）によって設定されたクッキーはブロックする

## ドメインは同一で、ポートが異なるクッキーについて

- ユーザーが hoge.com:8080 を閲覧している際に hoge.com:8080 から設定されるクッキーはファーストパーティクッキー
- 一方、hoge.com:8081 から設定されるクッキーは、ユーザーが hoge.com:8080 を閲覧している間はサードパーティクッキーとなる

# 課題２（実装）

- ngrok で app2 を公開する
- app を起動し、localhost:3000 にアクセスすると、index.html が提供され、ファーストパーティクッキーが設定される
- index.html が読み込まれると、img タグによって ngrok によって公開された URL から画像が取得され、サードパーティクッキーが設定される
- クロスサイトコンテキストでもサードパーティクッキーが設定されるようにするために、sameSite オプションは None、secure オプションは true に設定している。
- 結果: https://gyazo.com/cb2875a352e3b8263c7c7267f6a44a7d
