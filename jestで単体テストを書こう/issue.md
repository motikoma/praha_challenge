# jestで単体テストを書こう

## 課題2（実装）
課題を反映したコードは下記に格納<br>
https://github.com/motikoma/praha-challenge-templates/blob/master/jestSample/functions.ts 

## 課題3（質問）
### なぜ元の関数はカバレッジ100%のテストを書けなかったのでしょうか？
データを取得したり、保存する部分の処理がエラーになるとテスト結果が変わってしまうため

### 依存性の注入とは何でしょうか？
* 依存性の注入
* 外部で生成したインスタンスを引数として渡すこと
* 解決する問題
    * 外部のモジュールに依存せずに網羅的にテストを書きたい
    * テストの際にプロダクトコードを修正せずにてダミーデータを使用したい

### 依存性の注入を実施することで、モジュール同士の結合度の強さはどのように変化したでしょうか？
* モジュール同士の結合度は減少した

### 単体テストで外部サービスとの通信が発生する場合のデメリット
* 単体テストで通信が発生するとテストデータの準備が大変

### 単体テストの定義について
* 単体テスト: モジュールのテスト
* 統合テスト: モジュールを組み合わせたテスト

### sumOfArrayに空の配列を渡すと例外が発生する場合の修正
* プロダクトコード: https://github.com/motikoma/praha-challenge-templates/blob/master/jestSample/functions.ts
* テストコード: https://github.com/motikoma/praha-challenge-templates/blob/master/jestSample/__tests__/functions.test.ts 


### Property Based Testing について
* テストデータをランダムに半自動生成して、その生成された全ての値について、満たすべき性質を満たしているかテストする
* 既存のテストケースが積み上がった状態でテスト対象への変更が走った場合、テストを修正するコストがかさむ。これを使用すれば修正コストを減らすことができる。
* 採用しない方が良いケース: データベースとの通信も含めたテストの場合、一度の実行時間が長いので採用は非現実的な気がする
* 参考：https://gakuzzzz.github.io/slides/property_based_testing_for_domain/

### 単体テストケースを増やしても可読性、保守性、実行速度などに問題が起きないよう工夫できること
1. テストを仕様書として記載することで可読性と保守性が向上する
    * テストケース名は日本語で記載する
2. テストケースを疎結合にすることで保守性が向上する
    * 複数のテストケースで同一テストデータに依存しており、かつテスト実行によってテストデータが変更された場合、テストを追加する際に記載する期待値を読み解くことが難しくなる
3. アサーションルーレットを避けることで可読性が向上する
    * 1つのテストケースに複数のアサーションを詰め込むことをアサーションルーレットと言う
    * 失敗したAssert以降に記載されたAssertは実行されない
    * まとめて記載すると、どのAssertで失敗したのかわかりづらい
4. GivenWhenThenパターンの採用
    * 準備(given):Given では振る舞いを実行する前の状態
    * 実行(when):When では振る舞い
    * 検証(then):Then では振る舞いの結果

## 課題４（クイズ）
https://github.com/motikoma/praha-challenge-templates/tree/master/jestSample/quiz

### Jestに対するクイズ
* Jestにはテストを記述するためにitとtestの2つのメソッドがありますが、実際には同じ機能です。なぜ、2つの名前があるのでしょうか？

## 課題5（調査）
Axiosのテストコードを読んでみた結果
* Node.jsではcoreのモジュールとして assert が存在する。テストではassertが使用されている。expectと同様の挙動になるらしいが、なぜあえてassertを使っているのかまでは不明。
* describeとitを使って、テストケースが構造化されて見やすい
* テストしたい内容が明確なので1つのテストケースで使用されているassertの数が少ない